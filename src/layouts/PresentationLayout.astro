---
import type { CollectionEntry } from "astro:content";
import BaseLayout from "./BaseLayout.astro";
import dayjs from "dayjs";
import localizedFormat from "dayjs/plugin/localizedFormat";
import createSlug from "src/lib/createSlug";

interface Props {
  entry: CollectionEntry<"presentations">;
}

const { entry } = Astro.props;
const { title, event, presentation, tags = [], categories } = entry.data;

dayjs.extend(localizedFormat);
const displayDate = dayjs(presentation).format("ll");

---

<BaseLayout title={title} , ogType="article">
  <main class="md:flex md:justify-center" data-pagefind-body>
    <article class="prose prose-lg max-w-[1280px] prose-img:mx-auto">
      <h1 class="title my-2 text-4xl font-bold">{title}</h1>
      <!-- Date and Event on first line -->
      <div class="flex items-center flex-wrap gap-2 mb-2">
        {
          presentation && (
            <span>
              <svg
                class="inline-block -mt-0.5 dark:text-gray-400 h-4 w-4"
                data-icon="tabler:clock"
                height="1em"
                viewBox="0 0 24 24"
                width="1em"
              >
                <>
                  <symbol id="ai:tabler:clock">
                    <g
                      fill="none"
                      stroke="currentColor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <>
                        <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0-18 0" />
                        <path d="M12 7v5l3 3" />
                      </>
                    </g>
                  </symbol>
                  <use xlink:href="#ai:tabler:clock" />
                </>
              </svg>
              <time>{displayDate}</time>
            </span>
          )
        }
        {
          event && (
            <span class="ml-4">
              <svg
                class="inline-block -mt-0.5 dark:text-gray-400 h-4 w-4"
                data-icon="tabler:calendar"
                height="1em"
                viewBox="0 0 24 24"
                width="1em"
              >
                <>
                  <symbol id="ai:tabler:calendar">
                    <g
                      fill="none"
                      stroke="currentColor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <>
                        <path d="M4 7a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V7z" />
                        <path d="M16 3v4M8 3v4M4 11h16" />
                      </>
                    </g>
                  </symbol>
                  <use xlink:href="#ai:tabler:calendar" />
                </>
              </svg>
              <a class="badge badge-secondary rounded-full no-underline" href={`/presentations/event/${createSlug(event, event)}`}>
                {event}
              </a>
            </span>
          )
        }
      </div>
      
      <!-- Tags and Categories on second line -->
      <div class="flex items-center flex-wrap gap-2">
        {
          tags &&
            tags.map((tag) => (
              <a
                href={`/presentations/tag/${tag}`}
                class="badge badge-outline rounded-full no-underline"
              >
                {tag}
              </a>
            ))
        }
        {
          categories &&
            categories.map((cat) => (
              <a
                href={`/category/${cat}`}
                class="badge rounded-full no-underline"
              >
                {cat}
              </a>
            ))
        }
      </div>
      <div class="divider my-2"></div>
      <slot />
    </article>
  </main>
</BaseLayout>
